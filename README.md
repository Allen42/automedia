# AI漫剧剧本生成器

一个基于 Gemini Pro 的专业桌面应用，将长篇小说自动转换为符合短剧节奏的分镜剧本。通过 AI 智能拆解故事、规划分镜镜头，让创意工作变得高效而专业。

## 核心功能

### 1. 小说转剧本

将长篇小说改写为第一人称的短剧剧本，采用"人物自述 OS + 角色台词"的形式。系统会自动保留原小说的核心情节和人物性格，同时优化字数和节奏，使其适合短剧制作（每集约 60 秒）。

### 2. 分镜拆解

基于罗伯特·麦基的镜头拆解理论，将剧本按照**独立动作单元**自动拆解为标准化的分镜方案。每个镜头包含六个要素：时间、地点、镜头设计、人物行为、画面结果和观众情绪。系统确保每个镜头聚焦单一动作，禁止多动作堆砌，确保分镜的专业性和可执行性。

### 3. 节奏规划

根据爽文套路自动规划分镜镜头的展示顺序，并为每个镜头分配时长。系统遵循"反派嘲讽/打压主角 → 主角心理活动 → 主角打脸开始 → 对手反扑 → 主角的终极碾压"的节奏，确保观众的情绪起伏和故事的吸引力。

### 4. 可视化管理

直观的三栏式布局（导航 + 编辑 + 预览），支持项目管理、实时预览、统计信息和快速操作。用户可以轻松创建多个项目、上传小说、查看转换结果、编辑提示词和导出数据。

## 工作流程

### 第一步：创建项目

在左侧导航栏输入项目名称，点击"+"按钮创建新项目。每个项目独立存储小说、剧本、分镜和节奏规划数据。

### 第二步：上传小说

在"小说"标签页点击"选择文件"按钮，上传 .txt 格式的小说文件。系统支持直接编辑小说内容，方便进行快速调整。

### 第三步：转换为剧本

点击左侧的"转换为剧本"按钮，系统将调用 Gemini Pro API，根据内置的提示词模板自动将小说改写为第一人称剧本。转换过程中会显示加载动画，完成后自动切换到"剧本"标签页。

### 第四步：生成分镜

确保剧本内容已生成，点击"生成分镜"按钮。系统将按照分镜六要素自动拆解剧本，生成前 30 个标准化的分镜方案。分镜数据可在"分镜"标签页查看和编辑。

### 第五步：规划节奏

点击"规划节奏"按钮，系统将根据爽文套路为前 8 集分别规划分镜镜头的展示顺序和时长。节奏规划结果可在"节奏"标签页查看和调整。

### 第六步：导出和使用

完成规划后，点击顶部的"导出"按钮，系统支持导出为多种格式（JSON、CSV、Markdown 等），方便后续的制作和协作。

## 提示词模板

### 小说转剧本模板

系统内置的提示词模板包含以下要素：

- **角色定义**：资深编剧，精通网络文学改编和短剧创作
- **任务描述**：将小说改写为第一人称短剧剧本
- **格式要求**：人物自述 OS + 角色台词
- **优化目标**：字数控制、情感节点保留、短剧适配

用户可以在编辑器中查看和编辑提示词，以适应不同的创意需求。

### 分镜拆解模板

分镜拆解模板基于罗伯特·麦基的镜头理论，包含：

- **分镜六要素**：时间、地点、镜头设计、人物行为、画面结果、观众情绪
- **拆解原则**：独立动作单元、情绪节拍变化、标点规范
- **输出格式**：标准化的分镜描述，便于后续的分镜图绘制

### 节奏规划模板

节奏规划模板遵循爽文套路，包含：

- **套路定义**：反派嘲讽 → 主角心理活动 → 打脸开始 → 对手反扑 → 终极碾压
- **规划要求**：时长分配、镜头选择、情绪起伏
- **输出格式**：分集规划，包括开场、冲突、高潮、结尾

## 技术架构

### 前端框架

应用采用现代化的前端技术栈：

- **React 19**：最新的 React 版本，提供强大的组件系统
- **TypeScript**：类型安全的开发体验
- **Tailwind CSS 4**：高效的样式管理
- **shadcn/ui**：专业的 UI 组件库
- **Wouter**：轻量级的路由管理

### 设计系统

应用采用**现代极简主义 + 深色工作区**的设计风格：

- **色彩系统**：深灰蓝背景（#0f172a）+ 霓虹蓝（#0ea5e9）+ 紫罗兰（#a855f7）
- **排版系统**：Poppins（标题）+ Inter（正文）+ JetBrains Mono（代码）
- **布局范式**：三栏式设计（导航 + 编辑 + 预览）
- **交互设计**：平滑过渡、即时反馈、发光效果

### API 集成

应用通过 Gemini Pro API 实现 AI 功能：

- **API 端点**：通过环境变量 `VITE_FRONTEND_FORGE_API_URL` 配置
- **认证方式**：API Key 认证，通过环境变量 `VITE_FRONTEND_FORGE_API_KEY` 配置
- **请求格式**：JSON 格式的 REST API
- **错误处理**：完整的错误捕获和用户提示

## 环境配置

### 必需的环境变量

应用需要以下环境变量来正常运行：

| 变量名 | 说明 | 示例 |
|--------|------|------|
| `VITE_FRONTEND_FORGE_API_KEY` | Gemini Pro API Key | `your-api-key-here` |
| `VITE_FRONTEND_FORGE_API_URL` | Gemini Pro API 端点 | `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent` |

### 开发环境

在本地开发时，创建 `.env.local` 文件并配置上述环境变量：

```env
VITE_FRONTEND_FORGE_API_KEY=your-api-key-here
VITE_FRONTEND_FORGE_API_URL=https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent
```

## 安装和运行

### 安装依赖

```bash
pnpm install
```

### 开发模式

```bash
pnpm dev
```

应用将在 `http://localhost:3000` 启动。

### 生产构建

```bash
pnpm build
```

### 生产运行

```bash
pnpm start
```

## 文件结构

```
client/
├── public/
│   └── images/              # 应用图片资源
│       ├── hero-background.png
│       ├── storyboard-card-bg.png
│       └── workflow-illustration.png
├── src/
│   ├── components/          # UI 组件
│   │   └── ui/              # shadcn/ui 组件
│   ├── contexts/            # React Context
│   ├── hooks/               # 自定义 Hooks
│   │   └── useGemini.ts     # Gemini API Hook
│   ├── lib/                 # 工具函数
│   │   └── geminiService.ts # Gemini API 服务
│   ├── pages/               # 页面组件
│   │   ├── Home.tsx         # 主页面
│   │   └── Editor.tsx       # 编辑器页面
│   ├── App.tsx              # 应用入口
│   ├── main.tsx             # React 入口
│   └── index.css            # 全局样式
├── index.html               # HTML 模板
└── package.json             # 项目配置
```

## 使用示例

### 创建第一个项目

1. 打开应用，进入编辑器页面
2. 在左侧输入项目名称（如"穿越爽文"）
3. 点击"+"按钮创建项目
4. 项目将出现在"我的项目"列表中

### 上传和转换小说

1. 选择已创建的项目
2. 在"小说"标签页点击"选择文件"
3. 上传一个 .txt 格式的小说文件
4. 点击"转换为剧本"按钮
5. 等待转换完成，系统将自动切换到"剧本"标签页

### 生成分镜和规划节奏

1. 确保剧本已生成
2. 点击"生成分镜"按钮
3. 等待分镜生成完成
4. 点击"规划节奏"按钮
5. 查看节奏规划结果，可进行编辑和调整

## 常见问题

### Q: 应用支持哪些文件格式？

A: 目前应用支持 .txt 格式的小说文件。如需支持其他格式（如 .docx、.pdf），可联系开发者进行扩展。

### Q: 如何编辑生成的剧本、分镜或节奏规划？

A: 所有生成的内容都可以在对应的标签页中直接编辑。编辑内容会自动保存到项目中。

### Q: 如何导出项目数据？

A: 点击顶部的"导出"按钮，系统支持导出为 JSON、CSV、Markdown 等多种格式。

### Q: 应用是否支持多语言？

A: 目前应用仅支持中文。如需支持其他语言，可联系开发者进行本地化。

### Q: 如何自定义提示词？

A: 在编辑器中点击右侧预览面板的"编辑提示词"按钮，可以查看和修改当前使用的提示词模板。

## 性能优化

应用采用以下优化策略确保良好的用户体验：

- **代码分割**：使用 React 的 lazy loading 实现路由级别的代码分割
- **状态管理**：使用 React Hooks 进行本地状态管理，避免不必要的重新渲染
- **API 缓存**：对 API 响应进行缓存，减少重复请求
- **图片优化**：使用 WebP 格式和响应式图片，优化加载性能
- **CSS 优化**：使用 Tailwind CSS 的 PurgeCSS 功能，移除未使用的样式

## 安全性

应用遵循以下安全最佳实践：

- **API 认证**：使用 API Key 进行身份验证，所有请求都需要有效的 API Key
- **输入验证**：对用户输入进行验证和清理，防止注入攻击
- **错误处理**：不在错误消息中暴露敏感信息
- **HTTPS**：生产环境使用 HTTPS 加密传输
- **环境变量**：敏感信息（如 API Key）存储在环境变量中，不提交到代码仓库

## 贡献指南

欢迎贡献代码、报告问题或提出改进建议。请遵循以下步骤：

1. Fork 项目仓库
2. 创建特性分支（`git checkout -b feature/AmazingFeature`）
3. 提交更改（`git commit -m 'Add some AmazingFeature'`）
4. 推送到分支（`git push origin feature/AmazingFeature`）
5. 开启 Pull Request

## 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

## 联系方式

如有任何问题或建议，欢迎通过以下方式联系我们：

- 提交 GitHub Issue
- 发送邮件至 support@example.com
- 访问官方网站 https://example.com

## 更新日志

### v1.0.0（2024-01-16）

- ✨ 初始版本发布
- ✨ 实现小说转剧本功能
- ✨ 实现分镜拆解功能
- ✨ 实现节奏规划功能
- ✨ 完整的项目管理界面
- ✨ 深色工作区设计系统

## 致谢

感谢以下开源项目和工具的支持：

- [React](https://react.dev) - UI 库
- [Tailwind CSS](https://tailwindcss.com) - CSS 框架
- [shadcn/ui](https://ui.shadcn.com) - UI 组件库
- [Gemini Pro](https://ai.google.dev) - AI 模型
- [Vite](https://vitejs.dev) - 构建工具

---

**开发者**：Manus AI  
**最后更新**：2024-01-16  
**版本**：1.0.0
